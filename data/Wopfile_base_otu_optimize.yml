rule SampleInformation:
    tool: vtam.wrapper.SampleInformation
    input:
        file:
            fastainfo: {{fastainfo}}
    output:
        table:
            Run: vtam.model.Run
            Marker: vtam.model.Marker
            Biosample: vtam.model.Biosample
            Replicate: vtam.model.Replicate
            Fasta: vtam.model.Fasta
            PrimerPair: vtam.model.PrimerPair
            TagPair: vtam.model.TagPair
            SampleInformation: vtam.model.SampleInformation
    params:
        fasta_dir: {{fastadir}}
        log_verbosity: {{log_verbosity}}
        log_file: {{log_file}}

rule SortReads:
    tool: vtam.wrapper.SortReads
    input:
        table:
            Fasta: vtam.model.Fasta
            SampleInformation: vtam.model.SampleInformation
            Marker: vtam.model.Marker
        file:
            fastainfo: {{fastainfo}}
    output:
        file:
            sortreads: {{sortreads}}
    params:
        min_id: {{min_id}}
        minseqlength: {{minseqlength}}
        overhang: {{overhang}}
        log_verbosity: {{log_verbosity}}
        log_file: {{log_file}}
#
rule VariantReadCount:
    tool: vtam.wrapper.VariantReadCount
    input:
        file:
            sortreads: {{sortreads}}
            fastainfo: {{fastainfo}}
        table:
            Run: vtam.model.Run
            Marker: vtam.model.Marker
            Biosample: vtam.model.Biosample
            Replicate: vtam.model.Replicate
    output:
        table:
            Variant: vtam.model.Variant
            VariantReadCount: vtam.model.VariantReadCount
    params:
        log_verbosity: {{log_verbosity}}
        log_file: {{log_file}}


{% block rule_2nd_otu_optimize %}{% endblock %}

